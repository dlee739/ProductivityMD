\hypertarget{sha512_8h_source}{}\doxysection{sha512.\+h}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{6 \textcolor{preprocessor}{\#ifndef SHA512\_H}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#define SHA512\_H}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{12 \textcolor{keyword}{class }\mbox{\hyperlink{class_s_h_a512}{SHA512}}}
\DoxyCodeLine{13 \{}
\DoxyCodeLine{14 \textcolor{keyword}{protected}:}
\DoxyCodeLine{15     \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} uint8;}
\DoxyCodeLine{16     \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} uint32;}
\DoxyCodeLine{17     \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} uint64;}
\DoxyCodeLine{18  }
\DoxyCodeLine{19     \textcolor{keyword}{const} \textcolor{keyword}{static} uint64 \mbox{\hyperlink{class_s_h_a512_af6d393ef5aa7458c3545efa1b9d92900}{sha512\_k}}[];}
\DoxyCodeLine{20     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} SHA384\_512\_BLOCK\_SIZE = (1024/8);}
\DoxyCodeLine{21  }
\DoxyCodeLine{22 \textcolor{keyword}{public}:}
\DoxyCodeLine{23     \textcolor{keywordtype}{void} init();}
\DoxyCodeLine{24     \textcolor{keywordtype}{void} update(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *message, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} len);}
\DoxyCodeLine{25     \textcolor{keywordtype}{void} \textcolor{keyword}{final}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *digest);}
\DoxyCodeLine{26     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} DIGEST\_SIZE = ( 512 / 8);}
\DoxyCodeLine{27  }
\DoxyCodeLine{28 \textcolor{keyword}{protected}:}
\DoxyCodeLine{29     \textcolor{keywordtype}{void} transform(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *message, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} block\_nb);}
\DoxyCodeLine{30     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} m\_tot\_len;}
\DoxyCodeLine{31     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} m\_len;}
\DoxyCodeLine{32     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} m\_block[2 * SHA384\_512\_BLOCK\_SIZE];}
\DoxyCodeLine{33     uint64 m\_h[8];}
\DoxyCodeLine{34 \};}
\DoxyCodeLine{35  }
\DoxyCodeLine{36  }
\DoxyCodeLine{37 std::string sha512(std::string input);}
\DoxyCodeLine{38  }
\DoxyCodeLine{39 \textcolor{preprocessor}{\#define SHA2\_SHFR(x, n)    (x >> n)}}
\DoxyCodeLine{40 \textcolor{preprocessor}{\#define SHA2\_ROTR(x, n)   ((x >> n) | (x << ((sizeof(x) << 3) -\/ n)))}}
\DoxyCodeLine{41 \textcolor{preprocessor}{\#define SHA2\_ROTL(x, n)   ((x << n) | (x >> ((sizeof(x) << 3) -\/ n)))}}
\DoxyCodeLine{42 \textcolor{preprocessor}{\#define SHA2\_CH(x, y, z)  ((x \& y) \string^ (\string~x \& z))}}
\DoxyCodeLine{43 \textcolor{preprocessor}{\#define SHA2\_MAJ(x, y, z) ((x \& y) \string^ (x \& z) \string^ (y \& z))}}
\DoxyCodeLine{44 \textcolor{preprocessor}{\#define SHA512\_F1(x) (SHA2\_ROTR(x, 28) \string^ SHA2\_ROTR(x, 34) \string^ SHA2\_ROTR(x, 39))}}
\DoxyCodeLine{45 \textcolor{preprocessor}{\#define SHA512\_F2(x) (SHA2\_ROTR(x, 14) \string^ SHA2\_ROTR(x, 18) \string^ SHA2\_ROTR(x, 41))}}
\DoxyCodeLine{46 \textcolor{preprocessor}{\#define SHA512\_F3(x) (SHA2\_ROTR(x,  1) \string^ SHA2\_ROTR(x,  8) \string^ SHA2\_SHFR(x,  7))}}
\DoxyCodeLine{47 \textcolor{preprocessor}{\#define SHA512\_F4(x) (SHA2\_ROTR(x, 19) \string^ SHA2\_ROTR(x, 61) \string^ SHA2\_SHFR(x,  6))}}
\DoxyCodeLine{48 \textcolor{preprocessor}{\#define SHA2\_UNPACK32(x, str)                 \(\backslash\)}}
\DoxyCodeLine{49 \textcolor{preprocessor}{\{                                             \(\backslash\)}}
\DoxyCodeLine{50 \textcolor{preprocessor}{    *((str) + 3) = (uint8) ((x)      );       \(\backslash\)}}
\DoxyCodeLine{51 \textcolor{preprocessor}{    *((str) + 2) = (uint8) ((x) >>  8);       \(\backslash\)}}
\DoxyCodeLine{52 \textcolor{preprocessor}{    *((str) + 1) = (uint8) ((x) >> 16);       \(\backslash\)}}
\DoxyCodeLine{53 \textcolor{preprocessor}{    *((str) + 0) = (uint8) ((x) >> 24);       \(\backslash\)}}
\DoxyCodeLine{54 \textcolor{preprocessor}{\}}}
\DoxyCodeLine{55 \textcolor{preprocessor}{\#define SHA2\_UNPACK64(x, str)                 \(\backslash\)}}
\DoxyCodeLine{56 \textcolor{preprocessor}{\{                                             \(\backslash\)}}
\DoxyCodeLine{57 \textcolor{preprocessor}{    *((str) + 7) = (uint8) ((x)      );       \(\backslash\)}}
\DoxyCodeLine{58 \textcolor{preprocessor}{    *((str) + 6) = (uint8) ((x) >>  8);       \(\backslash\)}}
\DoxyCodeLine{59 \textcolor{preprocessor}{    *((str) + 5) = (uint8) ((x) >> 16);       \(\backslash\)}}
\DoxyCodeLine{60 \textcolor{preprocessor}{    *((str) + 4) = (uint8) ((x) >> 24);       \(\backslash\)}}
\DoxyCodeLine{61 \textcolor{preprocessor}{    *((str) + 3) = (uint8) ((x) >> 32);       \(\backslash\)}}
\DoxyCodeLine{62 \textcolor{preprocessor}{    *((str) + 2) = (uint8) ((x) >> 40);       \(\backslash\)}}
\DoxyCodeLine{63 \textcolor{preprocessor}{    *((str) + 1) = (uint8) ((x) >> 48);       \(\backslash\)}}
\DoxyCodeLine{64 \textcolor{preprocessor}{    *((str) + 0) = (uint8) ((x) >> 56);       \(\backslash\)}}
\DoxyCodeLine{65 \textcolor{preprocessor}{\}}}
\DoxyCodeLine{66 \textcolor{preprocessor}{\#define SHA2\_PACK64(str, x)                   \(\backslash\)}}
\DoxyCodeLine{67 \textcolor{preprocessor}{\{                                             \(\backslash\)}}
\DoxyCodeLine{68 \textcolor{preprocessor}{    *(x) =   ((uint64) *((str) + 7)      )    \(\backslash\)}}
\DoxyCodeLine{69 \textcolor{preprocessor}{           | ((uint64) *((str) + 6) <<  8)    \(\backslash\)}}
\DoxyCodeLine{70 \textcolor{preprocessor}{           | ((uint64) *((str) + 5) << 16)    \(\backslash\)}}
\DoxyCodeLine{71 \textcolor{preprocessor}{           | ((uint64) *((str) + 4) << 24)    \(\backslash\)}}
\DoxyCodeLine{72 \textcolor{preprocessor}{           | ((uint64) *((str) + 3) << 32)    \(\backslash\)}}
\DoxyCodeLine{73 \textcolor{preprocessor}{           | ((uint64) *((str) + 2) << 40)    \(\backslash\)}}
\DoxyCodeLine{74 \textcolor{preprocessor}{           | ((uint64) *((str) + 1) << 48)    \(\backslash\)}}
\DoxyCodeLine{75 \textcolor{preprocessor}{           | ((uint64) *((str) + 0) << 56);   \(\backslash\)}}
\DoxyCodeLine{76 \textcolor{preprocessor}{\}}}
\DoxyCodeLine{77  }
\DoxyCodeLine{78 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
